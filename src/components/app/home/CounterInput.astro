---
import Textarea from '@components/ui/Textarea.astro';
import { INPUT } from '@lib/config/input';
import { getLocaleStrings } from '@lib/i18n/index.ts';
import type { WithChildren } from '../../../types.ts';

/**
 * The main counter input textarea.
 */
type Props = WithChildren<false>;

const { label, placeholder } = getLocaleStrings(Astro).input;
---

<Textarea
	id={INPUT.id}
	{placeholder}
	aria-label={label}
	spellcheck="false"
	autofocus
	disabled
/>

<script>
	import { INPUT } from '@lib/config/input.ts';
	import { $inputText } from '@stores/index.ts';
	import { debounce, getDefinedElementById } from '@utils/index.ts';

	const updateInputText = debounce(() => $inputText.set(input.value));

	const input = getDefinedElementById<HTMLTextAreaElement>(INPUT.id);

	input.addEventListener('input', updateInputText);

	$inputText.subscribe((value) => {
		input.value = value;
	});

	input.disabled = false;
</script>
